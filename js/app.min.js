function gewinnwahrscheinlichkeit(n,e){return 1/(1+Math.pow(10,(e-n)/150))}var count=2,aenderungskonstante_default=16;angular.module("myApp",[]).controller("myController",["$scope",function($scope){$scope.aenderungskonstante=aenderungskonstante_default,$scope.new_ttr0="",$scope.opponents=[{nr:1,ttr:"",gw:"",gw_display:"",new_ttr:""},{nr:2,ttr:"",gw:"",gw_display:"",new_ttr:""}],$scope.addOpponent=function(){count++,$scope.opponents.push({nr:count,ttr:"",gw:"",gw_display:"",new_ttr:""})},$scope.calculate=function(){$scope.new_ttr0="";for(var i=0;i<$scope.opponents.length;i++)$scope.opponents[i].gw="",$scope.opponents[i].gw_display="",$scope.opponents[i].new_ttr="";isNaN($scope.current_ttr)||$scope.current_ttr<0||$scope.current_ttr>9999?$("input[name='input1']").parent().parent().addClass("has-error"):$("input[name='input1']").parent().parent().removeClass("has-error");for(var i=0;i<$scope.opponents.length;i++){var j=i+1;isNaN($scope.opponents[i].ttr)||$scope.opponents[i].ttr<0||$scope.opponents[i].ttr>9999?$("input[name='opponent"+j+"']").parent().parent().addClass("has-error"):$("input[name='opponent"+j+"']").parent().parent().removeClass("has-error")}if(!isNaN($scope.current_ttr)&&$scope.current_ttr>0&&$scope.current_ttr<1e4){for(var anz_opponents=0,sum_gw=0,i=0;i<$scope.opponents.length;i++)!isNaN($scope.opponents[i].ttr)&&$scope.opponents[i].ttr>0&&$scope.opponents[i].ttr<1e4&&(anz_opponents++,$scope.opponents[i].gw=gewinnwahrscheinlichkeit($scope.current_ttr,$scope.opponents[i].ttr),sum_gw+=$scope.opponents[i].gw,$scope.opponents[i].gw_display=Math.round(1e3*$scope.opponents[i].gw)/1e3);if(anz_opponents>0&&!isNaN($scope.aenderungskonstante)&&$scope.aenderungskonstante>0){$scope.new_ttr0=Math.round(eval($scope.current_ttr-$scope.aenderungskonstante*sum_gw));for(var i=1;anz_opponents>=i;i++)$scope.opponents[i-1].new_ttr=Math.round(eval($scope.current_ttr-$scope.aenderungskonstante*(sum_gw-i)))}}}}]);